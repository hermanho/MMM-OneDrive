/*! *****************************************************************************
  mmm-onedrive
  Version 1.8.0

  MagicMirrorÂ² module to display your photos from OneDrive.
  Please submit bugs at https://github.com/hermanho/MMM-OneDrive/issues

  (c) hermanho
  Licence: MIT

  This file is auto-generated. Do not edit.
***************************************************************************** */

!function(){"use strict";Module.register("MMM-OneDrive",{defaults:{albums:[],updateInterval:3e4,sort:"new",condition:{fromDate:null,toDate:null,minWidth:null,maxWidth:null,minHeight:null,maxHeight:null,minWHRatio:null,maxWHRatio:null},showWidth:1080,showHeight:1920,timeFormat:"YYYY/MM/DD HH:mm",autoInfoPosition:!1,forceAuthInteractive:!1},requiresVersion:"2.24.0",suspended:!1,getScripts:()=>["moment.js"],getStyles:function(){return["MMM-OneDrive.css"]},start:function(){this.firstScan=!0,this.config.updateInterval<1e4&&(this.config.updateInterval=1e4),this.config.condition=Object.assign({},this.defaults.condition,this.config.condition);const e=Object.assign({},this.config);for(let t=0;t<this.config.albums.length;t++){const n=this.config.albums[t];n instanceof RegExp&&(e.albums[t]={source:n.source,flags:n.flags})}this.sendSocketNotification("INIT",e),this.dynamicPosition=0},socketNotificationReceived:function(e,t){if("ERROR"===e){const e=document.getElementById("ONEDRIVE_PHOTO_CURRENT");e.textContent="";const n=document.createElement("div");Object.assign(n.style,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"});const i=document.createElement("div");Object.assign(i.style,{maxWidth:"70vw",fontSize:"1.5em"}),i.textContent=t,n.appendChild(i),e.appendChild(n)}if("CLEAR_ERROR"===e){const e=document.getElementById("ONEDRIVE_PHOTO_CURRENT");e&&(e.textContent="")}if("UPDATE_STATUS"===e){document.getElementById("ONEDRIVE_PHOTO_STATUS").innerHTML=String(t)}if("RENDER_PHOTO"===e){this.state={type:"newPhoto",payload:t};const{photo:e,album:n,url:i}=t;this.render(i,e,n)}},notificationReceived:function(e,t,n){"ONEDRIVE_PHOTO_NEXT"===e&&this.sendSocketNotification("NEXT_PHOTO",[])},cleanUpAlbumCoverMemory:function(){const e=document.getElementById("ONEDRIVE_PHOTO_INFO");e&&(e.innerHTML="")},cleanUpPresentPhotoMemory:function(){const e=document.getElementById("ONEDRIVE_PHOTO_BACKDROP"),t=document.getElementById("ONEDRIVE_PHOTO_CURRENT");if(e){e.querySelectorAll("img").forEach(e=>{try{e.src=""}catch(e){}}),e.innerHTML=""}if(t){t.querySelectorAll("img").forEach(e=>{try{e.src=""}catch(e){}}),t.innerHTML=""}},render:function(e,t,n){if(this.suspended)return void console.info("[MMM-OneDrive] Module is suspended, skipping render");this.cleanUpPresentPhotoMemory(),this.cleanUpAlbumCoverMemory();const i=document.getElementById("ONEDRIVE_PHOTO_BACKDROP"),o=document.createElement("img");o.src=e,i.appendChild(o);const s=document.getElementById("ONEDRIVE_PHOTO_CURRENT"),d=document.createElement("img");d.id="ONEDRIVE_PHOTO_IMG",s.appendChild(d),d.src=e,s.classList.add("animated");const c=document.getElementById("ONEDRIVE_PHOTO_INFO");if(this.config.autoInfoPosition){let e=(e,t)=>{const n=new Date;return[[0,"none","none",0],["none","none",0,0],["none",0,0,"none"],[0,0,"none","none"]][Math.floor(n.getMinutes()/15)]};"function"==typeof this.config.autoInfoPosition&&(e=this.config.autoInfoPosition);const[i,o,s,d]=e(n,t);c.style.setProperty("--top",String(i)),c.style.setProperty("--left",String(o)),c.style.setProperty("--bottom",String(s)),c.style.setProperty("--right",String(d))}const a=document.createElement("div");a.classList.add("albumCover");const l=document.createElement("img");l.src=`modules/MMM-OneDrive/cache/${n.id}`,a.appendChild(l),c.appendChild(a);const r=document.createElement("div");r.classList.add("albumTitle"),r.innerHTML=n.name;const m=document.createElement("div");m.classList.add("photoTime"),m.innerHTML="relative"===this.config.timeFormat?moment(t.mediaMetadata.dateTimeOriginal).fromNow():moment(t.mediaMetadata.dateTimeOriginal).format(this.config.timeFormat);const E=document.createElement("div");E.classList.add("infoText"),E.appendChild(r),E.appendChild(m),c.appendChild(E),console.debug("[MMM-OneDrive] render image done",JSON.stringify({id:t.id,filename:t.filename})),this.sendSocketNotification("IMAGE_LOADED",{id:t.id,filename:t.filename,index:t._indexOfPhotos})},getDom:function(){this.cleanUpPresentPhotoMemory(),this.cleanUpAlbumCoverMemory();const e=document.getElementById("ONEDRIVE_PHOTO");e&&e.remove();const t=document.createElement("div");t.id="ONEDRIVE_PHOTO";const n=document.createElement("div");n.id="ONEDRIVE_PHOTO_BACKDROP";const i=document.createElement("div");i.id="ONEDRIVE_PHOTO_CURRENT",-1===this.data.position.search("fullscreen")&&(this.config.showWidth&&(t.style.width=this.config.showWidth+"px"),this.config.showHeight&&(t.style.height=this.config.showHeight+"px")),i.addEventListener("animationend",()=>{i.classList.remove("animated")});const o=document.createElement("div");o.id="ONEDRIVE_PHOTO_OVERLAY";const s=document.createElement("div");s.id="ONEDRIVE_PHOTO_STATUS_WRAPPER";const d=document.createElement("div");d.id="ONEDRIVE_PHOTO_STATUS",d.innerHTML="Loading...";const c=document.createElement("div");c.id="ONEDRIVE_PHOTO_INFO_WRAPPER";const a=document.createElement("div");return a.id="ONEDRIVE_PHOTO_INFO",t.appendChild(n),t.appendChild(i),t.appendChild(o),o.appendChild(c),c.appendChild(a),o.appendChild(s),s.appendChild(d),console.info("[MMM-OneDrive] Dom updated!"),t},suspend(){this.sendSocketNotification("MODULE_SUSPENDED",void 0),this.suspended=!0,this.cleanUpPresentPhotoMemory(),this.cleanUpAlbumCoverMemory();document.getElementById("ONEDRIVE_PHOTO_STATUS").innerHTML=""},resume(){this.sendSocketNotification("MODULE_RESUMED",void 0),this.suspended=!1}})}();
//# sourceMappingURL=MMM-OneDrive.js.map
