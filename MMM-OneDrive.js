/*! *****************************************************************************
  mmm-onedrive
  Version 1.4.2

  MagicMirrorÂ² module to display your photos from OneDrive.
  Please submit bugs at https://github.com/hermanho/MMM-OneDrive/issues

  (c) hermanho
  Licence: MIT

  This file is auto-generated. Do not edit.
***************************************************************************** */

!function(){"use strict";Module.register("MMM-OneDrive",{defaults:{albums:[],updateInterval:3e4,sort:"new",condition:{fromDate:null,toDate:null,minWidth:null,maxWidth:null,minHeight:null,maxHeight:null,minWHRatio:null,maxWHRatio:null},showWidth:1080,showHeight:1920,timeFormat:"YYYY/MM/DD HH:mm",autoInfoPosition:!1,forceAuthInteractive:!1},requiresVersion:"2.24.0",suspended:!1,getScripts:()=>["moment.js"],getStyles:function(){return["MMM-OneDrive.css"]},start:function(){this.uploadableAlbum=null,this.albums=null,this.scanned=[],this.updateTimer=null,this.index=0,this.needMorePicsFlag=!0,this.firstScan=!0,this.config.updateInterval<1e4&&(this.config.updateInterval=1e4),this.config.condition=Object.assign({},this.defaults.condition,this.config.condition);const t=Object.assign({},this.config);for(let e=0;e<this.config.albums.length;e++){const i=this.config.albums[e];i instanceof RegExp&&(t.albums[e]={source:i.source,flags:i.flags})}this.sendSocketNotification("INIT",t),this.dynamicPosition=0},socketNotificationReceived:function(t,e){if("UPLOADABLE_ALBUM"===t&&(this.uploadableAlbum=e),"UPDATE_ALBUMS"===t&&(this.albums=e),"ERROR"===t){const t=document.getElementById("ONEDRIVE_PHOTO_CURRENT");t.textContent="";const i=document.createElement("div");Object.assign(i.style,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"});const n=document.createElement("div");Object.assign(n.style,{maxWidth:"70vw",fontSize:"1.5em"}),n.textContent=e,i.appendChild(n),t.appendChild(i)}if("CLEAR_ERROR"===t){document.getElementById("ONEDRIVE_PHOTO_CURRENT").textContent=""}if("UPDATE_STATUS"===t){document.getElementById("ONEDRIVE_PHOTO_INFO").innerHTML=String(e)}"NEW_PHOTO"===t&&(this.state={type:"newPhoto",payload:e},this.updateDom())},notificationReceived:function(t,e,i){"ONEDRIVE_PHOTO_NEXT"===t&&this.sendSocketNotification("NEXT_PHOTO",[])},getDom:function(){var t;const e=document.createElement("div");e.id="ONEDRIVE_PHOTO";const i=document.createElement("div");i.id="ONEDRIVE_PHOTO_BACK";const n=document.createElement("div");n.id="ONEDRIVE_PHOTO_CURRENT",-1===this.data.position.search("fullscreen")&&(this.config.showWidth&&(e.style.width=this.config.showWidth+"px"),this.config.showHeight&&(e.style.height=this.config.showHeight+"px")),n.addEventListener("animationend",(()=>{n.classList.remove("animated")}));const o=document.createElement("div");switch(o.id="ONEDRIVE_PHOTO_INFO",o.innerHTML="Loading...",e.appendChild(i),e.appendChild(n),e.appendChild(o),null===(t=this.state)||void 0===t?void 0:t.type){case"newPhoto":{const{photoBase64:t,photo:e,album:s}=this.state.payload,a=`data:${"image/heic"===e.mimeType?"image/jpeg":e.mimeType};base64,${t}`;if(Log.debug("[MMM-OneDrive] render image",{id:e.id}),n.classList.add("animated"),n.textContent="",i.style.backgroundImage=`url('${a}')`,n.style.backgroundImage=`url('${a}')`,this.config.autoInfoPosition){let t=(t,e)=>{const i=new Date;return[[0,"none","none",0],["none","none",0,0],["none",0,0,"none"],[0,0,"none","none"]][Math.floor(i.getMinutes()/15)]};"function"==typeof this.config.autoInfoPosition&&(t=this.config.autoInfoPosition);const[i,n,a,d]=t(s,e);o.style.setProperty("--top",String(i)),o.style.setProperty("--left",String(n)),o.style.setProperty("--bottom",String(a)),o.style.setProperty("--right",String(d))}o.innerHTML="";const d=document.createElement("div");d.classList.add("albumCover"),d.style.backgroundImage=`url(modules/MMM-OneDrive/cache/${s.id})`;const c=document.createElement("div");c.classList.add("albumTitle"),c.innerHTML=s.title;const l=document.createElement("div");l.classList.add("photoTime"),l.innerHTML="relative"===this.config.timeFormat?moment(e.mediaMetadata.dateTimeOriginal).fromNow():moment(e.mediaMetadata.dateTimeOriginal).format(this.config.timeFormat);const m=document.createElement("div");m.classList.add("infoText"),o.appendChild(d),m.appendChild(c),m.appendChild(l),o.appendChild(m);break}}return Log.info("[MMM-OneDrive] Dom updated!"),e},suspend(){this.sendSocketNotification("MODULE_SUSPENDED",void 0),this.suspended=!0},resume(){this.sendSocketNotification("MODULE_RESUMED",void 0),this.suspended=!1}})}();
//# sourceMappingURL=MMM-OneDrive.js.map
